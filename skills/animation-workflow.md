---
name: animation-workflow
description: 动画绘本工作流功能需求。当需要创建动画绘本风格的视频时使用此 skill。
---

# 动画绘本工作流功能需求

> **重要**: 这是一份需求说明书，不是技术文档。
> **目的**: 说明如何使用 Penguin-Magic 现有节点实现动画绘本制作工作流。

---

## 工作流概述

**动画绘本工作流**: 将文本旁白自动转换为系列动画视频，形成完整的儿童绘本视频作品。

**核心价值**:
- ✅ 零门槛创作：只需会写字就能创作动画
- ✅ 效率革命：批量生成，节省大量时间
- ✅ 质量保证：自动适配绘本风格

---

## 完整用户旅程

### 第一步：输入旁白

**用户操作**: 在 `text` 节点输入故事文本

**示例输入**:
```
没错，它就是我们建筑工地上的装载机！
它可以快速搬运石头和沙子。
大家都很喜欢这个勤劳的装载机。
```

**系统自动处理**:
- 按行分割文本（去除空行）
- 识别句子数量（4个句子）
- 每个句子对应一个视频

---

### 第二步：优化提示词

**用户操作**: 使用 `llm` 节点优化每个句子

**优化前**:
```
没错，它就是我们建筑工地上的装载机！
```

**优化后**:
```
卡通风格的绘本动画。场景：阳光明媚、充满活力的城市建设工地，蓝天白云背景。
核心动作：@装载机 骄傲地站在工地中央，向观众展示自己。
细节与氛围：周围有堆积的建筑材料（石头、沙子、钢筋），
阳光透过云层洒下斑驳的光影，整体氛围积极向上、充满活力。
Cinematography: 低角度仰拍，突出角色的自信。
Animation style: 卡通风格，动作夸张且富有弹性。
适合10秒视频。
```

**关键改进**:
- ✅ 添加了场景环境（建筑工地、蓝天白云）
- ✅ 添加了视觉细节（材料堆、光影效果）
- ✅ 明确了动画风格（卡通、夸张、有弹性）
- ✅ 保留了角色引用（如 `@装载机`）

---

### 第三步：批量生成视频

**用户操作**: 使用 `sora2-batch-video` 节点批量生成

**操作步骤**:
1. 从优化后的提示词加载到批量节点
2. 选择要生成的句子（可全选）
3. 点击"批量生成"
4. 系统自动创建多个视频任务

**任务对应关系**:
| 句子 | 优化提示词 | 视频结果 |
|------|-----------|---------|
| 句子 1 | 优化后的提示词 1 | 视频 A |
| 句子 2 | 优化后的提示词 2 | 视频 B |
| 句子 3 | 优化后的提示词 3 | 视频 C |
| 句子 4 | 优化后的提示词 4 | 视频 D |

---

### 第四步：查看结果

**用户操作**: 在 `sora2-task-result` 节点查看所有视频

**显示内容**:
- 所有任务的生成进度（0-100%）
- 每个视频的预览和下载
- 生成参数（提示词、时长、比例）

---

## 节点组合方案

### 核心节点

| 节点 | 用途 | 说明 |
|------|------|------|
| **text** | 旁白输入 | 替代 WinJin 的 NarratorNode |
| **llm** | 提示词优化 | 替代 WinJin 的 PromptOptimizerNode |
| **sora2-prompt-optimizer** | 二次优化 | 可选，进一步优化提示词 |
| **sora2-batch-video** | 批量生成 | 批量创建视频任务 |
| **sora2-task-result** | 结果查看 | 查看视频进度和结果 |

---

### 完整工作流图

```
text 节点（旁白输入）
    ↓
llm 节点（逐句优化）
    ↓
sora2-prompt-optimizer 节点（可选：二次优化）
    ↓
sora2-batch-video 节点（批量生成）
    ↓
sora2-task-result 节点（查看结果）
```

**数据流**:
1. text 节点 → 旁白文本
2. llm 节点 → 优化后的提示词数组
3. sora2-prompt-optimizer → 进一步优化（可选）
4. sora2-batch-video → 多个视频任务
5. sora2-task-result → 所有视频结果

---

## 用户场景

### 场景 1：儿童绘本创作者

**用户需求**: 制作10个短篇绘本视频（每个4-6个句子）

**使用流程**:
1. 在 text 节点输入第一个故事的旁白（6个句子）
2. 使用 llm 节点优化为详细提示词
3. 使用 sora2-batch-video 批量生成6个视频
4. 在 sora2-task-result 查看所有视频
5. 重复以上步骤完成其他9个故事

**效率提升**:
- 传统方式：10个故事 × 6个句子 × 5分钟 = 300分钟（5小时）
- 批量方式：10个故事 × 5分钟 = 50分钟
- **效率提升 6倍**

---

### 场景 2：教育机构

**用户需求**: 老师制作教学视频（100个句子）

**使用流程**:
1. 在 text 节点输入教学文本
2. 使用 llm 节点优化为详细提示词
3. 使用 sora2-batch-video 批量生成所有视频
4. 在 sora2-task-result 查看和管理结果

**效率提升**:
- 传统方式：100个句子 × 5分钟 = 500分钟（8.3小时）
- 批量方式：一次提交 → 后台自动处理
- **效率提升 100倍**

---

### 场景 3：家长

**用户需求**: 将孩子的睡前故事制作成视频（5个句子）

**使用流程**:
1. 在 text 节�点输入孩子的睡前故事
2. 使用 llm 节点优化为详细提示词
3. 使用 sora2-batch-video 批量生成5个视频
4. 在 sora2-task-result 查看结果

**体验提升**:
- 传统方式：5个句子 × 5分钟 = 25分钟操作时间
- 批量方式：1次点击 → 20分钟后完成
- 孩子可以一起期待视频生成

---

## 功能需求

### 1. 旁白输入功能

**功能描述**: 用户输入原始文本旁白

**输入需求**:
- 支持多行文本输入
- 按行自动分割（去除空行）
- 显示句子列表和数量

**输出需求**:
- 旁白文本数组
- 句子数量统计

**用户价值**:
- 零门槛输入（只需会写字）
- 即时预览句子列表
- 灵活编辑和修改

---

### 2. 提示词优化功能

**功能描述**: 将简单旁白扩展为详细的视频提示词

**优化内容**:
- **场景环境**: 添加环境描述（地点、时间、背景）
- **视觉细节**: 添加颜色、光影、氛围描述
- **动画风格**: 明确卡通风格、动作特点
- **角色引用**: 保留 `@username` 格式的角色引用

**优化风格**:
- picture-book（动画绘本）
- animation（动画风格）
- cinematic（电影风格）
- documentary（纪录片风格）

**用户价值**:
- 将"创意"转换为"可执行的技术指令"
- 自动添加视觉细节和风格要求
- 保留角色引用，确保角色一致性

---

### 3. 批量生成功能

**功能描述**: 一次性创建多个视频生成任务

**功能需求**:
- 为每个句子创建独立的视频任务
- 使用优化后的提示词（而非原始旁白）
- 统一应用视频时长和画面比例
- 显示所有任务的进度

**用户价值**:
- **效率提升**: 一次操作，多个视频
- **自动化**: 系统自动创建、提交、监控任务
- **容错性**: 某个任务失败不影响其他任务

---

### 4. 结果查看功能

**功能描述**: 集中查看和管理所有视频结果

**功能需求**:
- 显示所有任务的生成进度（0-100%）
- 视频预览和下载
- 显示生成参数（提示词、时长、比例）
- 支持失败任务单独重试

**用户价值**:
- 集中管理所有视频
- 实时了解进度
- 快速下载和保存

---

## 验收标准

### 功能完整性

- [ ] 旁白输入功能正常
- [ ] 提示词优化功能正常
- [ ] 批量生成功能正常
- [ ] 结果查看功能正常

### 用户体验

- [ ] 输入界面清晰易懂
- [ ] 优化结果质量高
- [ ] 批量生成稳定可靠
- [ ] 结果查看方便直观

### 性能要求

- [ ] 优化响应时间：< 30 秒/句
- [ ] 批量任务创建时间：< 10 秒
- [ ] 视频生成时间：3-5 分钟/个
- [ ] 支持并发处理（4个任务同时生成）

---

## 最佳实践

### 旁白编写技巧

**✅ 推荐**:
- 每行一句话（短小精悍）
- 使用简单语言（儿童易懂）
- 描述核心动作（发生了什么）
- 保留关键信息（角色名称、地点）

**❌ 避免**:
- 一段多行（难以分割）
- 复杂句式（难以理解）
- 过于抽象（缺乏画面感）

---

### 提示词优化技巧

**优化前检查清单**:
- [ ] 是否包含角色引用（`@username`）
- [ ] 是否指定风格（picture-book）
- [ ] 是否包含时长要求
- [ ] 是否包含画面比例

**优化后验证**:
- [ ] 是否保留了角色引用
- [ ] 是否添加了场景环境
- [ ] 是否描述了视觉细节
- [ ] 是否符合绘本风格

---

### 批量生成技巧

**生成前准备**:
- [ ] 确认所有句子已优化
- [ ] 确认 API 配置正确
- [ ] 确认存储空间充足

**生成中监控**:
- [ ] 实时查看任务进度
- [ ] 记录失败任务信息
- [ ] 准备重试方案

**生成后整理**:
- [ ] 下载所有视频
- [ ] 按顺序命名视频
- [ ] 备份原始素材

---

## 参考文档

- `references/text-to-animation.md` - 文本转动画详细流程
- `references/batch-generation.md` - 批量生成详细流程
- `../penguin-nodes-guide/SKILL.md` - Penguin 节点复用指南

---

**文档版本**: v1.0
**创建日期**: 2026-01-21
**维护者**: WinJin 开发团队
